buildscript {
    repositories {
        maven {
            url "https://jcenter.bintray.com"
        }
    }
    dependencies {
        classpath 'com.github.jengelman.gradle.plugins:shadow:1.2.4'
    }
}

apply plugin: 'com.github.johnrengelman.shadow'
apply plugin: 'application'

dependencies {
    compile project(":dsb-api")
    compile project(":dsb-local")
    compile project(":dsb-util")
    compile 'com.fasterxml.jackson.core:jackson-databind:2.6.4'
}

shadowJar {
    def version
    def console = System.console()
    if (console) {
        version = console.readLine('>>> Please enter Version number here: ')

    } else {
        logger.error "Cannot get console."
    }
    dependencies {
        exclude 'org.mockito:mockito-core:1.10.19'
        exclude 'junit:junit:4.12'
        include 'processResources'
    }

    new File("${project.rootDir}/dsb-gui/src/main/resources/version.properties").withWriter { w ->
        Properties p = new Properties()
        p['version'] = version.toString()
        p.store w, null
    }
    project.version = version
}
